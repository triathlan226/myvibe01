<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-pop Visual Arena</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Custom Tailwind Config for Animation -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'gradient': 'gradient 8s linear infinite',
                    },
                    keyframes: {
                        gradient: {
                            '0%, 100%': {
                                'background-size': '200% 200%',
                                'background-position': 'left center'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'right center'
                            },
                        },
                    },
                },
            },
        }
    </script>
    
    <style>
        body {
            background-color: #121212;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden; /* Prevent scrolling during battle */
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons Components (Inline SVG) ---
        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/></svg>
        );
        const Crown = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>
        );
        const Sparkles = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/></svg>
        );
        const BarChart2 = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/></svg>
        );
        const ArrowRight = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
        );
        const Download = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
        );

        // --- Data ---
        const getNetImage = (keyword) => 
            `https://tse2.mm.bing.net/th?q=${encodeURIComponent(keyword + ' kpop legendary visual')}&w=400&h=500&c=7&rs=1&p=0`;

        const INITIAL_IDOLS = [
            // --- 第四代 ---
            { id: '4-1', name: 'Irene (裴柱現)', group: 'Red Velvet', gen: '4th', keyword: 'Irene Red Velvet', pickCount: 210 },
            { id: '4-2', name: 'Tzuyu (周子瑜)', group: 'TWICE', gen: '4th', keyword: 'Tzuyu TWICE', pickCount: 230 },
            { id: '4-3', name: 'Jisoo (金智秀)', group: 'BLACKPINK', gen: '4th', keyword: 'Jisoo BLACKPINK', pickCount: 225 },
            { id: '4-4', name: 'Sana (湊崎紗夏)', group: 'TWICE', gen: '4th', keyword: 'Sana TWICE', pickCount: 200 },
            { id: '4-5', name: 'Jennie (金珍妮)', group: 'BLACKPINK', gen: '4th', keyword: 'Jennie BLACKPINK', pickCount: 215 },
            { id: '4-6', name: 'Joy (朴秀英)', group: 'Red Velvet', gen: '4th', keyword: 'Joy Red Velvet', pickCount: 180 },
            { id: '4-7', name: 'Mina (名井南)', group: 'TWICE', gen: '4th', keyword: 'Mina TWICE', pickCount: 195 },
            { id: '4-8', name: 'Rosé (朴彩英)', group: 'BLACKPINK', gen: '4th', keyword: 'Rose BLACKPINK', pickCount: 190 },
            { id: '4-9', name: 'Lisa (拉莉莎)', group: 'BLACKPINK', gen: '4th', keyword: 'Lisa BLACKPINK', pickCount: 205 },
            { id: '4-10', name: 'Nayeon (林娜璉)', group: 'TWICE', gen: '4th', keyword: 'Nayeon TWICE', pickCount: 185 },

            // --- 第五代 ---
            { id: '5-1', name: 'Karina (柳智敏)', group: 'aespa', gen: '5th', keyword: 'Karina aespa', pickCount: 160 },
            { id: '5-2', name: 'Wonyoung (張員瑛)', group: 'IVE', gen: '5th', keyword: 'Wonyoung IVE', pickCount: 170 },
            { id: '5-3', name: 'Miyeon (曹薇娟)', group: '(G)I-DLE', gen: '5th', keyword: 'Miyeon GIDLE', pickCount: 130 },
            { id: '5-4', name: 'Yuna (申有娜)', group: 'ITZY', gen: '5th', keyword: 'Yuna ITZY', pickCount: 140 },
            { id: '5-5', name: 'Minju (金珉周)', group: 'IZ*ONE', gen: '5th', keyword: 'Kim Minju IZONE', pickCount: 145 },
            { id: '5-6', name: 'Yujin (安俞真)', group: 'IVE', gen: '5th', keyword: 'An Yujin IVE', pickCount: 135 },
            { id: '5-7', name: 'Winter (金旼炡)', group: 'aespa', gen: '5th', keyword: 'Winter aespa', pickCount: 148 },
            { id: '5-8', name: 'Yoon (沈姿潤)', group: 'STAYC', gen: '5th', keyword: 'Yoon STAYC', pickCount: 110 },
            { id: '5-9', name: 'Shuhua (葉舒華)', group: '(G)I-DLE', gen: '5th', keyword: 'Shuhua GIDLE', pickCount: 125 },
            { id: '5-10', name: 'Yeji (黃禮志)', group: 'ITZY', gen: '5th', keyword: 'Yeji ITZY', pickCount: 128 },
            { id: '5-11', name: 'Sakura (宮脇咲良)', group: 'IZ*ONE/LSF', gen: '5th', keyword: 'Sakura LE SSERAFIM', pickCount: 155 },

            // --- 第六代 ---
            { id: '6-1', name: 'Minji (金珉池)', group: 'NewJeans', gen: '6th', keyword: 'Minji NewJeans', pickCount: 138 },
            { id: '6-2', name: 'Sullyoon (薛侖娥)', group: 'NMIXX', gen: '6th', keyword: 'Sullyoon NMIXX', pickCount: 120 },
            { id: '6-3', name: 'Kazuha (中村一葉)', group: 'LE SSERAFIM', gen: '6th', keyword: 'Kazuha LE SSERAFIM', pickCount: 110 },
            { id: '6-4', name: 'Haerin (姜海潾)', group: 'NewJeans', gen: '6th', keyword: 'Haerin NewJeans', pickCount: 135 },
            { id: '6-5', name: 'Ahyeon (鄭雅晛)', group: 'BABYMONSTER', gen: '6th', keyword: 'Ahyeon BABYMONSTER', pickCount: 90 },
            { id: '6-6', name: 'Wonhee (李沅禧)', group: 'ILLIT', gen: '6th', keyword: 'Wonhee ILLIT', pickCount: 85 },
            { id: '6-7', name: 'Natty', group: 'KISS OF LIFE', gen: '6th', keyword: 'Natty KISS OF LIFE', pickCount: 95 },
            { id: '6-8', name: 'Hanni (范玉欣)', group: 'NewJeans', gen: '6th', keyword: 'Hanni NewJeans', pickCount: 130 },
            { id: '6-9', name: 'Chaewon (金采源)', group: 'LE SSERAFIM', gen: '6th', keyword: 'Kim Chaewon LE SSERAFIM', pickCount: 125 },
            { id: '6-10', name: 'Minju (朴敏珠)', group: 'ILLIT', gen: '6th', keyword: 'Minju ILLIT', pickCount: 88 },
        ];

        const shuffleArray = (array) => {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        };

        // --- Components ---

        const Button = ({ children, onClick, variant = 'primary', className = '' }) => {
            const baseStyle = "px-6 py-3 rounded-full font-bold transition-all duration-300 transform active:scale-95 tracking-wide flex items-center justify-center";
            const variants = {
                primary: "bg-purple-600 hover:bg-purple-500 text-white shadow-[0_0_15px_rgba(147,51,234,0.5)] hover:shadow-[0_0_25px_rgba(147,51,234,0.7)] border border-purple-500/50",
                secondary: "bg-[#2a2a2a] hover:bg-[#333] text-gray-200 border border-gray-700",
                outline: "bg-transparent border-2 border-purple-500 text-purple-400 hover:bg-purple-500/10 hover:text-purple-300",
                gold: "bg-gradient-to-r from-yellow-600 to-yellow-500 hover:from-yellow-500 hover:to-yellow-400 text-black shadow-[0_0_15px_rgba(202,138,4,0.5)]"
            };

            return (
                <button onClick={onClick} className={`${baseStyle} ${variants[variant]} ${className}`}>
                    {children}
                </button>
            );
        };

        const IdolCard = ({ idol, onClick, status, side }) => {
            let animationClass = "opacity-100 scale-100";
            let filterClass = "";

            if (status === 'eliminated') {
                animationClass = "opacity-0 translate-y-full rotate-6 duration-1000 ease-in pointer-events-none";
                filterClass = "grayscale-[100%] brightness-50"; 
            } else if (status === 'selected') {
                animationClass = "scale-105 shadow-[0_0_40px_rgba(168,85,247,0.4)] z-20 duration-500 ring-2 ring-purple-500";
            } else if (status === 'entering') {
                const startPos = side === 'left' ? '-translate-x-full opacity-0' : 'translate-x-full opacity-0';
                animationClass = `${startPos} animate-in slide-in duration-500`;
            } else {
                animationClass = "hover:scale-105 hover:shadow-[0_0_20px_rgba(255,255,255,0.2)] duration-300 cursor-pointer hover:z-10";
            }

            const imageUrl = getNetImage(idol.keyword);

            return (
                <div 
                    onClick={status === 'idle' ? onClick : undefined}
                    className={`relative group w-[40vw] max-w-[280px] aspect-[3/4] rounded-xl overflow-hidden transition-all transform bg-[#1e1e1e] border border-white/5 ${animationClass}`}
                >
                    <img 
                        src={imageUrl} 
                        alt={idol.name} 
                        className={`w-full h-full object-cover transition-all duration-1000 ${filterClass}`}
                        onError={(e) => {
                            e.target.onerror = null; 
                            e.target.src = "https://placehold.co/400x500/222/FFF?text=Image+N/A"; 
                        }}
                    />
                    <div className={`absolute inset-0 bg-gradient-to-t from-black/90 via-black/10 to-transparent flex flex-col justify-end p-4 transition-opacity duration-300 ${status === 'eliminated' ? 'opacity-0' : 'opacity-100'}`}>
                        <h3 className="text-lg md:text-2xl font-bold text-white mb-1 group-hover:text-purple-300 transition-colors tracking-tight shadow-black drop-shadow-md truncate">{idol.name}</h3>
                        <p className="text-gray-400 font-medium tracking-wider text-xs md:text-sm flex items-center gap-2">
                            {idol.group}
                            {status === 'selected' && <Crown size={12} className="text-yellow-500 animate-bounce" />}
                        </p>
                    </div>
                    {status === 'selected' && (
                        <div className="absolute inset-0 bg-white/10 animate-pulse pointer-events-none" />
                    )}
                    {status === 'eliminated' && (
                        <div className="absolute inset-0 bg-black/50 z-10 backdrop-blur-[2px]" />
                    )}
                </div>
            );
        };

        // --- Main App ---

        function App() {
            const [screen, setScreen] = useState('home'); 
            const [selectedGen, setSelectedGen] = useState(null);
            const [db, setDb] = useState(INITIAL_IDOLS);
            
            const [gameQueue, setGameQueue] = useState([]); 
            const [leftIdol, setLeftIdol] = useState(null);
            const [rightIdol, setRightIdol] = useState(null);
            const [leftStatus, setLeftStatus] = useState('idle');
            const [rightStatus, setRightStatus] = useState('idle');
            
            const [streak, setStreak] = useState(0); 
            const [champion, setChampion] = useState(null);

            useEffect(() => {
                const saved = localStorage.getItem('kpop_visual_arena_db_v4'); 
                if (saved) {
                    try {
                        const parsed = JSON.parse(saved);
                        const merged = INITIAL_IDOLS.map(initItem => {
                            const found = parsed.find(p => p.id === initItem.id);
                            return found ? { ...initItem, pickCount: found.pickCount } : initItem;
                        });
                        setDb(merged);
                    } catch (e) {
                        console.error("Error loading DB", e);
                    }
                }
            }, []);

            const updateVote = (winnerId) => {
                const newDb = db.map(idol => 
                    idol.id === winnerId ? { ...idol, pickCount: (idol.pickCount || 0) + 1 } : idol
                );
                setDb(newDb);
                localStorage.setItem('kpop_visual_arena_db_v4', JSON.stringify(newDb));
            };

            const startGame = (gen) => {
                setSelectedGen(gen);
                
                const pool = db.filter(idol => idol.gen === gen);
                const shuffled = shuffleArray(pool);
                
                if (shuffled.length < 2) {
                    alert("該世代資料人數不足以進行比賽，請稍後再試！");
                    return;
                }

                const p1 = shuffled[0];
                const p2 = shuffled[1];
                const rest = shuffled.slice(2);

                setLeftIdol(p1);
                setRightIdol(p2);
                setGameQueue(rest);
                
                setLeftStatus('idle');
                setRightStatus('idle');
                setStreak(0);
                setChampion(null);
                setScreen('battle');
            };

            const handlePick = (side) => {
                if (leftStatus !== 'idle' || rightStatus !== 'idle') return;

                const winner = side === 'left' ? leftIdol : rightIdol;
                
                updateVote(winner.id);
                setStreak(s => s + 1);

                if (side === 'left') {
                    setLeftStatus('selected');
                    setRightStatus('eliminated');
                } else {
                    setRightStatus('selected');
                    setLeftStatus('eliminated');
                }

                setTimeout(() => {
                    if (gameQueue.length === 0) {
                        setChampion(winner);
                        setScreen('result');
                    } else {
                        const nextChallenger = gameQueue[0];
                        const newQueue = gameQueue.slice(1);
                        
                        setGameQueue(newQueue);

                        if (side === 'left') {
                            setLeftStatus('idle');
                            setRightIdol(nextChallenger);
                            setRightStatus('entering');
                            setTimeout(() => setRightStatus('idle'), 500);
                        } else {
                            setRightStatus('idle');
                            setLeftIdol(nextChallenger);
                            setLeftStatus('entering');
                            setTimeout(() => setLeftStatus('idle'), 500);
                        }
                    }
                }, 1000);
            };

            // 下載功能
            const handleDownloadGame = () => {
                // 為了避免重複下載的內容中包含 React 渲染的 root，我們構造一個乾淨的 HTML 字串
                const htmlContent = `<!DOCTYPE html>
<html lang="zh-TW">
${document.documentElement.innerHTML}
</html>`;
                
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'kpop_visual_arena.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            const renderHome = () => (
                <div className="flex flex-col items-center justify-center min-h-screen relative overflow-hidden bg-[#121212]">
                    <div className="absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(124,58,237,0.1),transparent_70%)] pointer-events-none"></div>
                    
                    <div className="z-10 text-center space-y-12 p-6 max-w-6xl w-full">
                        <div className="space-y-6 animate-in fade-in zoom-in duration-1000">
                            <div className="flex items-center justify-center gap-3 text-purple-400 mb-2">
                                <Sparkles size={20} />
                                <span className="tracking-[0.4em] text-xs font-bold uppercase text-purple-200">K-POP Visual Queen</span>
                                <Sparkles size={20} />
                            </div>
                            <h1 className="text-5xl md:text-8xl font-black text-white tracking-tighter leading-none shadow-2xl">
                                女團顏值<br />
                                <span className="text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-purple-400 bg-[length:200%_auto] animate-gradient">頂點對決</span>
                            </h1>
                            <p className="text-gray-400 max-w-lg mx-auto text-lg font-light">
                                誰能留在擂台上直到最後？<br/>
                                選出你心中的唯一真神。
                            </p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 w-full">
                            {[
                                { id: '4th', label: '第四代女團', sub: 'Red Velvet / TWICE / BP' },
                                { id: '5th', label: '第五代女團', sub: 'IVE / aespa / (G)I-DLE' },
                                { id: '6th', label: '第六代女團', sub: 'NewJeans / LSF / NMIXX' }
                            ].map((item) => (
                                <div key={item.id} className="relative group perspective-1000">
                                    <div className="absolute -inset-0.5 bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl blur opacity-20 group-hover:opacity-100 transition duration-500"></div>
                                    <button 
                                        onClick={() => startGame(item.id)}
                                        className="relative w-full h-full bg-[#181818] hover:bg-[#202020] text-white py-12 px-6 rounded-xl transition-all border border-white/5 flex flex-col items-center justify-center group-hover:translate-y-[-5px]"
                                    >
                                        <div className="text-5xl font-bold mb-4 font-mono text-white/10 group-hover:text-white/20 transition-colors absolute top-4 right-4">{item.id}</div>
                                        <div className="text-2xl font-bold mb-1 z-10">{item.label}</div>
                                        <div className="text-xs text-gray-500 uppercase tracking-widest group-hover:text-purple-400 z-10 text-center leading-relaxed">{item.sub}</div>
                                    </button>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* 下載按鈕 */}
                    <div className="absolute bottom-6 left-6 z-50">
                        <button 
                            onClick={handleDownloadGame}
                            className="flex items-center gap-2 px-4 py-2 bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white rounded-lg transition text-sm border border-white/5"
                        >
                            <Download size={16} />
                            下載遊戲檔案
                        </button>
                    </div>
                </div>
            );

            const renderBattle = () => {
                const total = db.filter(i => i.gen === selectedGen).length;
                const remaining = gameQueue.length + 1; 
                const done = total - remaining;
                const progress = (done / (total - 1)) * 100;

                return (
                    <div className="flex flex-col h-screen max-h-screen overflow-hidden bg-[#121212]">
                        <div className="h-14 flex items-center justify-between px-4 border-b border-white/5 bg-[#121212]/90 backdrop-blur-md z-30 shrink-0">
                            <div className="flex items-center gap-4">
                                <span className="px-3 py-1 rounded bg-purple-900/30 text-purple-300 text-xs font-bold tracking-wider border border-purple-500/30">
                                    {selectedGen} GEN
                                </span>
                                <div className="flex items-center gap-2 text-sm text-gray-400">
                                    <span>連勝: <span className="text-white font-mono text-lg">{streak}</span></span>
                                </div>
                            </div>
                            <button onClick={() => setScreen('home')} className="p-2 rounded-full hover:bg-white/10 text-gray-500 hover:text-white transition">
                                <RotateCcw size={18} />
                            </button>
                        </div>
                        
                        <div className="w-full h-1 bg-gray-900 shrink-0">
                            <div 
                                className="h-full bg-gradient-to-r from-purple-600 to-pink-500 transition-all duration-500 ease-out shadow-[0_0_10px_rgba(168,85,247,0.5)]"
                                style={{ width: `${progress}%` }}
                            />
                        </div>

                        <div className="flex-1 flex flex-row items-center justify-center gap-2 md:gap-8 p-2 relative overflow-hidden">
                            <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-0 pointer-events-none select-none">
                                <span className="text-[80px] md:text-[150px] font-black text-white/[0.03] italic">VS</span>
                            </div>

                            <div className="flex-1 flex justify-end z-10 min-w-0">
                                {leftIdol && (
                                    <IdolCard 
                                        key={leftIdol.id} 
                                        idol={leftIdol} 
                                        side="left"
                                        status={leftStatus}
                                        onClick={() => handlePick('left')}
                                    />
                                )}
                            </div>

                            <div className="flex-1 flex justify-start z-10 min-w-0">
                                {rightIdol && (
                                    <IdolCard 
                                        key={rightIdol.id}
                                        idol={rightIdol} 
                                        side="right"
                                        status={rightStatus}
                                        onClick={() => handlePick('right')}
                                    />
                                )}
                            </div>
                        </div>

                        <div className="h-16 flex flex-col items-center justify-center pb-4 z-20 shrink-0">
                            <p className="text-gray-500 text-sm animate-pulse">點擊圖片選擇勝者</p>
                        </div>
                    </div>
                );
            };

            const renderResult = () => {
                const leaderboard = [...db]
                    .filter(i => i.gen === selectedGen)
                    .sort((a, b) => b.pickCount - a.pickCount)
                    .slice(0, 10);
                    
                const champImg = getNetImage(champion?.keyword);

                return (
                    <div className="min-h-screen py-12 px-4 overflow-y-auto bg-[#121212]">
                        <div className="max-w-4xl mx-auto space-y-16">
                            
                            <div className="text-center space-y-8 animate-in fade-in slide-in-from-bottom-10 duration-1000">
                                <div className="space-y-2">
                                    <div className="inline-flex items-center gap-2 px-4 py-1 rounded-full bg-yellow-500/10 border border-yellow-500/20 text-yellow-500 text-sm font-bold tracking-widest uppercase mb-4">
                                        <Crown size={16} />
                                        Champion
                                    </div>
                                    <h2 className="text-4xl md:text-6xl font-black text-white">顏值頂點誕生</h2>
                                </div>
                                
                                <div className="relative inline-block mx-auto group">
                                    <div className="absolute -inset-10 bg-gradient-to-t from-purple-600 via-pink-600 to-yellow-500 opacity-20 blur-2xl rounded-full group-hover:opacity-40 transition duration-1000"></div>
                                    
                                    <div className="relative transform transition hover:scale-105 duration-500">
                                        <img 
                                            src={champImg} 
                                            alt={champion?.name} 
                                            className="w-64 h-80 md:w-80 md:h-96 object-cover rounded-2xl shadow-2xl ring-4 ring-yellow-500/30"
                                        />
                                        <div className="absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-black via-black/50 to-transparent rounded-b-2xl">
                                            <div className="text-3xl font-bold text-white mb-1">{champion?.name}</div>
                                            <div className="text-yellow-500 font-mono">{champion?.group}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="flex flex-col md:flex-row justify-center gap-4">
                                <Button variant="gold" onClick={() => startGame(selectedGen)} className="w-full md:w-auto">
                                    <RotateCcw size={18} className="inline mr-2" />
                                    再次挑戰 ({selectedGen})
                                </Button>
                                <Button variant="secondary" onClick={() => setScreen('home')} className="w-full md:w-auto">
                                    <ArrowRight size={18} className="inline mr-2" />
                                    返回主選單
                                </Button>
                            </div>

                            <div className="bg-[#1a1a1a] rounded-3xl p-6 md:p-10 border border-white/5 shadow-2xl">
                                <div className="flex items-center justify-between mb-8 pb-6 border-b border-white/5">
                                    <div className="flex items-center gap-3">
                                        <div className="p-3 bg-purple-500/10 rounded-xl text-purple-400">
                                            <BarChart2 size={24} />
                                        </div>
                                        <div>
                                            <h3 className="text-2xl font-bold text-white">{selectedGen} 全球排行榜</h3>
                                            <p className="text-sm text-gray-500">Global Pick Count Top 10</p>
                                        </div>
                                    </div>
                                </div>

                                <div className="space-y-3">
                                    {leaderboard.map((idol, idx) => (
                                        <div key={idol.id} className="flex items-center gap-4 p-4 rounded-xl bg-[#222] hover:bg-[#2a2a2a] transition border border-transparent hover:border-purple-500/30 group">
                                            <div className={`
                                                w-10 h-10 flex items-center justify-center font-bold rounded-lg text-lg
                                                ${idx === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-black shadow-lg shadow-yellow-500/20' : 
                                                idx === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-black' : 
                                                idx === 2 ? 'bg-gradient-to-br from-amber-700 to-amber-900 text-white' : 'bg-white/5 text-gray-500'}
                                            `}>
                                                {idx + 1}
                                            </div>
                                            
                                            <img src={getNetImage(idol.keyword)} alt={idol.name} className="w-14 h-14 rounded-full object-cover ring-2 ring-white/5 group-hover:ring-purple-500/50 transition" />
                                            
                                            <div className="flex-1">
                                                <div className="flex items-center gap-2">
                                                    <span className="font-bold text-white text-lg group-hover:text-purple-300 transition">{idol.name}</span>
                                                    {idx === 0 && <Crown size={14} className="text-yellow-500" />}
                                                </div>
                                                <div className="text-sm text-gray-500">{idol.group}</div>
                                            </div>
                                            
                                            <div className="text-right">
                                                <div className="text-lg font-mono font-bold text-purple-400">{idol.pickCount}</div>
                                                <div className="text-[10px] text-gray-600 uppercase tracking-wider">Wins</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="font-sans selection:bg-purple-500/30 h-screen w-screen overflow-hidden">
                    {screen === 'home' && renderHome()}
                    {screen === 'battle' && renderBattle()}
                    {screen === 'result' && renderResult()}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>